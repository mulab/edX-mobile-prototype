<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>build_base</title>
	<link rel="stylesheet" href="./css/jquery.mobile-1.3.0.css"/>
    <link rel="stylesheet" href="./css/jquery.mobile.flatui.css"/>
    <link rel="stylesheet" href="./css/jquery.mobile.structure-1.3.0.css">
    <link rel="stylesheet" href="./css/jquery.mobile.theme-1.3.0.css">
    <link rel="stylesheet" href="./css/jquery-mobile-fluid960.min.css">
	<script type="text/javascript" src="./js/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="./js/jquery.mobile-1.3.0.js"></script>
    <script type="text/javascript" src="rte/cordova.js"></script>
    <script type="text/javascript" src="rte/rte.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <link rel="stylesheet" href="css/style.css" />
    <script type="text/javascript">
    	var forBuild = true;
    	$(document).ready(function() {
    		if (forBuild) {
    			alert("start building");
    			buildpath = {};
    			$.getJSON("./build.json", function(data) {
    				buildpath = data;
    				$.get(buildpath["build-path"] + "template.html", function(r) {
    					$('body').html(r);
    					$.ajaxSetup({
    						async: false
    					});
    					$.getJSON(buildpath["build-path"] + "config.json", function(cr) {
    						var childArray = cr["child"];
    						for (var childIndex in childArray) {
    							var child = childArray[childIndex];
    							var selector = child["selector"];
    							var exPath = child["ex-path"];
    							var exCssList = child["ex-css"];
    							var exJsList = child["ex-js"];
    							var innerHtml = child["inner-html"];
    							if (exPath) {
    								var includePath = buildpath["build-path"] + exPath;
    								for(var cssIndex in exCssList){
                                        $('head').append('<link rel="stylesheet" href="'+includePath+exCssList[cssIndex] +'" />');
                                    }
                                    for(var jsIndex in exJsList){
                                        $('head').append("<script type='text/javascript' src='"+includePath+exJsList[jsIndex]+'" />');
                                    }
    								if (innerHtml) {
    									$.get(buildpath["build-path"] + exPath + innerHtml, function(ir) {
    										$(selector).html(ir);
    									});
    								}
    							}
    						}
    					});
    					$.ajaxSetup({
    						async: true
    					});
    					var html = $('html').html();
    					$('body').append('<div>result:</div><div id="result"></div>');
    					$('#result').text("'<html>" + html + "</html>'");
    				});
    			});
    		}
    	});
    </script>
</head>
<body>
	
</body>
</html>